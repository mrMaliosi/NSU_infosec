# LSB Steganography (24-bit BMP)

Консольное приложение на C++ для внедрения и извлечения сообщений методом LSB в 24-битные BMP-изображения. Поддерживает автоматическое кодирование длины сообщения, проверку вместимости, корректную работу с паддингом строк и выбор входного/выходного файла для обоих режимов.

## Язык
- C++

## Требования

- Компилятор C++17+ (g++/clang++/MSVC)

## Структура

main.cpp — основной файл с реализацией:

- Парсинг/запись заголовка BMP (BITMAPFILEHEADER + BITMAPINFOHEADER в упакованной структуре).

- Чтение/запись пикселей с учетом паддинга и порядка строк.

- Кодирование/декодирование сообщения в/из LSB.

- Меню с двумя режимами: внедрение и извлечение.

Форматы данных:

- Pixel { b, g, r } — один пиксель (3 байта).

- Поток LSB-битов: сначала 32 бита длины сообщения в битах, затем полезные биты сообщения.

## Сборка

Собрать тестовый исполняемый файл одной командой на Unix‑подобных системах или в MinGW/MSYS2 можно так:  

```bash
g++ main.cpp -o main; ./main
```

## Описание функционала
### Возможности
Внедрение текстового сообщения в 24-битный BMP:

- Сообщение вводится с клавиатуры.

- Перевод в двоичный вид побайтно (8 бит на символ).

- Добавление 32-битного заголовка длины (в битах) перед полезными битами.

- Запись по схеме LSB в каналы R, G, B, по одному биту на канал (3 бита на пиксель).

- Проверка вместимости: если не хватает битов, операция не выполняется.

- Сохранение нового BMP с корректным bfSize/biSizeImage, паддингом и порядком строк.

Извлечение сообщения из 24-битного BMP:

- Выбор файла для извлечения.

- Считывание первых 32 бит длины, затем указанного количества бит сообщения.

- Сборка обратно в символы по 8 бит (ASCII/UTF-8 байты без валидации кодировки).

- Вывод извлеченного текста в консоль.

## Детали реализации
Работа с BMP:

- Заголовок читается в упакованную структуру (pragma pack 1), проверяются:

    - bfType == 'BM'

    - biBitCount == 24

    - biCompression == 0

- Строки пикселей выровнены по 4 байта (row_padded = (width*3 + 3) & ~3).

- При чтении:

    - Поддерживается bottom-up (height > 0) и top-down (height < 0).

    - Пиксели нормализуются в вектор в порядке top-down для удобства.

- При записи:

    - Сохраняется как bottom-up (положительная biHeight).

    - biSizeImage и bfSize пересчитываются.

    - Паддинг заполняется нулями.

### Встраивание/извлечение:

**Поток бит:** 32 бита длины сообщения (в битах), big-endian представление, затем полезные биты.
Каналы: порядок R, G, B для согласованности.
**Вместимость:** capacityBits = widthheight3.
**Максимальная длина сообщения в байтах:** floor(((W×H×3) − 32)/8).

## Ограничения

- Только 24-битные BMP без сжатия (BI_RGB).

- Сообщение трактуется как последовательность байтов; валидация и нормализация UTF-8 не выполняются.

- Базовая стеганографическая устойчивость (LSB без рандомизации/маскировки).

